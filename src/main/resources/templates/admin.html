<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta charset="UTF-8">
    <title>Admin page</title>
</head>
<body>
<h2>All users</h2>
<table style="color: darkslategray">
  <thead>
  <tr>
    <th>Id</th>
    <th>Username</th>
    <th>Password</th>
    <th>Age</th>
    <th>Email</th>
    <th>Role</th>
    <th>Edit</th>
    <th>Delete</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="user : ${allUsers}">
    <td th:text="${user.getId()}"></td>
    <td th:text="${user.getUsername()}"></td>
    <td th:text="${user.getPassword()}"></td>
    <td th:text="${user.getAge()}"></td>
    <td th:text="${user.getEmail()}"></td>
    <td> <p th:each ="role : ${user.getRoles()}" th:text=" ${role.getName()}"></p></td>
    <td>
      <form th:method="GET" th:action="@{/admin/{id}/edit(id=${user.getId()})}">
        <input type="submit" value="Edit">
      </form>
    </td>
    <td>
      <form th:method="DELETE" th:action="@{/admin/{id}/delete(id=${user.getId()})}">
        <input type="hidden" value="${user}">
        <button type="submit">Delete</button>
      </form>
    </td>
  </tr>
  </tbody>
</table>
<br/><br/>

<form th:action="@{/admin/new}" th:method="GET">
  <input type="submit" value="Create new user">
</form>
<br/><hr/>
<form th:action="@{/logout}" th:method="POST">
  <input type="submit" value="Logout">
</form>



<!-- new -->
<h2>Create a new user</h2>

<form th:method="POST" th:action="@{/admin/saveNewUser}" th:object="${user}">
  <label for="username">Enter your username: </label>
  <input type="text" th:field="*{username}" id="username"/>
  <br/>
  <label for="password">Enter your password: </label>
  <input type="password" th:field="*{password}" id="password"/>
  <br/>
  <label for="age">Enter your age: </label>
  <input type="number" th:field="*{age}" id="age"/>
  <br/>
  <label for="email">Enter your email: </label>
  <input type="email" th:field="*{email}" id="email"/>
  <br/>

  <p>
    <label>Roles:
      <input type="checkbox" name="roles"
             th:each="role : ${roles}"
             th:value="${role.getId()}"
             th:text="${role.getName()}"
             th:field="*{roles}"
      />
    </label>
  </p>

  <br/>
  <input type="submit" value="Create!"/>
</form>

<br/>
<hr/>
<form th:action="@{/logout}" th:method="POST">
  <input type="submit" value="Logout">
</form>




<!-- edit -->
<h2>Edit user</h2>
<br>
<form th:method="PATCH"
      th:action="@{/admin/{id}(id=${user.getId()})}"
      th:object="${user}">

  <label for="username">Username: </label>
  <input type="text" th:field="*{username}" id="username">
  <br><br>

  <label for="password">Password: </label>
  <input type="text" th:field="*{password}" id="password">
  <br><br>

  <label for="age">Age: </label>
  <input type="number" th:field="*{age}" id="age">
  <br><br>

  <label for="email">Email: </label>
  <input type="email" th:field="*{email}" id="email">
  <br><br>

  <p>
    <label for="roles">Roles:
      <input type="checkbox" name="roles" id="roles"
             th:each="role : ${roles}"
             th:value="${role.getId()}"
             th:text="${role.getName()}"
             th:field="*{roles}"/>
    </label>
  </p>
  <br>
  <input type="submit" value="Update!"/>
</form>
<br><hr/>
<form th:action="@{/logout}" th:method="POST">
  <input type="submit" value="Logout">
</form>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>
</body>
</html>